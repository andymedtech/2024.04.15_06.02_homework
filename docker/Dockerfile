# образ для конфигурации берём из Docker Hub
# указываем версию дистрибутива Node - Alpine Linux
# называем создаваемый образ build, что бы к нему можно было обращаться
FROM node:22-alpine3.18 as build

# прописываем путь к рабочей директории
# эта папка в последствии удалится, когда дойдём до следующего образа
WORKDIR /app

# указываем какие файлы копируем в образ (всё из папки в корень образа)
# скопируй всё
COPY . .

# после сборки запускаем компиляцию образа (находимся внутри образа)
RUN npm install
RUN npm run build

# передаём проект в nginx
FROM nginx:1.25.5

COPY --from=build ./app/dist ./usr/share/nginx/html

# открываем порт
EXPOSE 80

# компилируем образ
# > docker build -f ./docker/Dockerfile -t node_vue .

# компилируем контейнер
# > docker run -p 28080:80 node_vue

# видим результат в браузере
# http://127.0.0.1:28080
